<!DOCTYPE html>
<html>
<head>
    <title>Kamus Mandarin Saya</title>
    
    <!-- KODE KONEKSI KE DATABASE -->
    <script type="module">
        // KODE INI SEPERTI PASSWORD UNTUK MASUK KE DATABASE
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

        // INI PASSWORD DATABASE ANDA (copy dari Firebase)
        const firebaseConfig = {
            apiKey: "AIzaSyCD_9fpJ0f7n3mG-Px7Lg8D4GErnyTyMA",
            authDomain: "kosa-kata-b7afb.firebaseapp.com",
            projectId: "kosa-kata-b7afb",
            storageBucket: "kosa-kata-b7afb.firebasestorage.app",
            messagingSenderId: "325184409554",
            appId: "1:325184409554:web:6c019dbcaa3de30be274d3"
        };

        // NYALAKAN KONEKSI KE DATABASE
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        
        // SIMPAN KONEKSI INI AGAR BISA DIPAKAI DI MANA SAJA
        window.databaseSaya = db;
        console.log("‚úÖ Berhasil connect ke database!");
    </script>
</head>
<body>
    <h1>üìñ Kamus Mandarin Saya</h1>

    <!-- FORM UNTUK TAMBAH KOSA KATA -->
    <div style="background: #f0f0f0; padding: 20px; margin: 20px 0; border-radius: 10px;">
        <h2>‚ûï Tambah Kosa Kata Baru</h2>
        <form id="formTambah">
            <input type="text" id="mandarin" placeholderÊ±âÂ≠ó (contoh: ‰Ω†Â•Ω)" required style="width: 100%; padding: 10px; margin: 5px 0;">
            <br>
            <input type="text" id="pinyin" placeholder="Pinyin (contoh: n«ê h«éo)" required style="width: 100%; padding: 10px; margin: 5px 0;">
            <br>
            <input type="text" id="arti" placeholder="Arti Indonesia (contoh: halo)" required style="width: 100%; padding: 10px; margin: 5px 0;">
            <br>
            <button type="submit" style="width: 100%; padding: 10px; background: #4CAF50; color: white; border: none; border-radius: 5px;">
                üíæ Simpan Kosa Kata
            </button>
        </form>
        <div id="pesan"></div>
    </div>

    <!-- TEMPAT UNTUK MENAMPILKAN KOSA KATA -->
    <div id="daftarKosaKata">
        <h2>üìö Kosa Kata Saya</h2>
        <p>Kosa kata akan muncul di sini...</p>
    </div>

    <!-- SCRIPT UNTUK FUNGSI TAMBAH/TAMPIL DATA -->
    <script type="module">
        // IMPORT FUNGSI YANG DIPERLUKAN
        import { collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

        // AMBIL KONEKSI DATABASE YANG SUDAH DISIMPAN
        const db = window.databaseSaya;

        // FUNGSI UNTUK TAMBAH KOSA KATA
        document.getElementById('formTambah').addEventListener('submit', async function(e) {
            e.preventDefault(); // JANGAN REFRESH HALAMAN
            
            // AMBIL DATA DARI FORM
            const mandarin = document.getElementById('mandarin').value;
            const pinyin = document.getElementById('pinyin').value;
            const arti = document.getElementById('arti').value;

            // SIMPAN KE DATABASE
            try {
                await addDoc(collection(db, "kosakata"), {
                    mandarin: mandarin,
                    pinyin: pinyin,
                    indonesia: arti,
                    tanggal: new Date()
                });
                
                // TAMPILKAN PESAN SUKSES
                document.getElementById('pesan').innerHTML = '<p style="color: green; background: #e6ffe6; padding: 10px;">‚úÖ Kosa kata berhasil disimpan!</p>';
                
                // KOSONGKAN FORM
                document.getElementById('formTambah').reset();
                
                // TAMPILKAN ULANG DAFTAR KOSA KATA
                tampilkanKosaKata();
            } catch (error) {
                document.getElementById('pesan').innerHTML = '<p style="color: red; background: #ffe6e6; padding: 10px;">‚ùå Gagal menyimpan: ' + error.message + '</p>';
            }
        });

        // FUNGSI UNTUK MENAMPILKAN KOSA KATA
        async function tampilkanKosaKata() {
            try {
                const querySnapshot = await getDocs(collection(db, "kosakata"));
                let html = '<h2>üìö Kosa Kata Saya</h2>';
                
                if (querySnapshot.empty) {
                    html += '<p>Belum ada kosa kata. Tambahkan yang pertama!</p>';
                } else {
                    querySnapshot.forEach((doc) => {
                        const data = doc.data();
                        html += `
                            <div style="background: white; padding: 15px; margin: 10px 0; border-radius: 5px; border-left: 4px solid #4CAF50;">
                                <div style="font-size: 24px; font-weight: bold;">${data.mandarin}</div>
                                <div style="color: #666; font-style: italic;">${data.pinyin}</div>
                                <div style="color: #333;">${data.indonesia}</div>
                            </div>
                        `;
                    });
                }
                
                document.getElementById('daftarKosaKata').innerHTML = html;
            } catch (error) {
                console.error("Error:", error);
            }
        }

        // JALANKAN FUNGSI PERTAMA KALI
        tampilkanKosaKata();
    </script>
</body>
</html>
